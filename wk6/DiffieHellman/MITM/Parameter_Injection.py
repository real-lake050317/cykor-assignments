from pwn import *
from Crypto.Util.number import long_to_bytes
import json
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad, unpad
import hashlib

g=0x02
print(f"g = {g}")

p=0xffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff
print(f"p = {p}")
A=0x9c02c1d3892df5c2f76b1983b20edec07d449b1058bacb4189d2556f78c08b82e6a8dca3139ec75c7a3a1d506065f73fc89c10c054474b2622b5cfb8e46a4b25fe6b8fabfe72109986cb5d2917fc694e2e18e640adbdcc53481f70f73c11250a9cff6413bab4050a09849813cbf1be6d03b6c149149b62d77501bde0292ecfbccf4b0dbdec771a10107e99668157bf5314c49892e646b9b4c3519c29c1ae5ec2ff85223290d05a1841419d897fe3b3f66c2df4f897658608fa1d0674b0d202a5
print(f"A = {A}")

b=197395083814907028991785772714920885908249341925650951555219049411298436217190605190824934787336279228785809783531814507661385111220639329358048196339626065676869119737979175531770768861808581110311903548567424039264485661330995221907803300824165469977099494284722831845653985392791480264712091293580274947132480402319812110462641143884577706335859190668240694680261160210609506891842793868297672619625924001403035676872189455767944077542198064499486164431451944
B=1241972460522075344783337556660700537760331108332735677863862813666578639518899293226399921252049655031563612905395145236854443334774555982204857895716383215705498970395379526698761468932147200650513626028263449605755661189525521343142979265044068409405667549241125597387173006460145379759986272191990675988873894208956851773331039747840312455221354589910726982819203421992729738296452820365553759182547255998984882158393688119629609067647494762616719047466973581
print(f"pow(g,b,p) = {pow(g,b,p)}")
print(f"B = {B}")

sec = pow(A,b,p)
print(f"secret={sec}")
